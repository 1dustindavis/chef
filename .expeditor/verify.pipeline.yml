---
expeditor:
  cached_folders:
    - vendor
  defaults:
    buildkite:
      retry:
        automatic:
          limit: 1
      timeout_in_minutes: 30

steps:

- label: ":habicat: Linux plan"
  commands:
    - sudo ./scripts/ci/install-hab.sh 'x86_64-linux'
    - sudo ./scripts/ci/verify-plan.sh
  timeout_in_minutes: 60
  expeditor:
    executor:
      linux:
        privileged: true
        single-use: true

- label: ":habicat: Linux plan (kernel2)"
  commands:
    - sudo ./scripts/ci/install-hab.sh 'x86_64-linux-kernel2'
    - sudo ./scripts/ci/verify-plan.sh
  timeout_in_minutes: 60
  expeditor:
    executor:
      linux:
        privileged: true
        single-use: true

- label: ":habicat: Windows plan"
  commands:
    - ./scripts/ci/verify-plan.ps1
  expeditor:
    executor:
      windows:
        privileged: true
